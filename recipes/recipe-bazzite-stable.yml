---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: bazzite-stable
description: My personal flavor of Bazzite
base-image: ghcr.io/ublue-os/bazzite
image-version: stable

modules:
  - type: containerfile
    snippets:
      - COPY --from=ghcr.io/ublue-os/config:latest /files/ublue-os-udev-rules /
      - ADD https://openrgb.org/releases/release_0.9/60-openrgb.rules /usr/lib/udev/rules.d

  - type: files
    files:
      - source: system
        destination: /

  - type: dnf
    repos:
      copr:
        - atim/starship
        - emixampp/synology-drive
        - hhd-dev/hhd
    install:
      packages:
        - adjustor
        - cdrskin
        - clatd
        - hhd
        - hhd-ui
        - hw-probe
        - htop
        - k3b
        - https://github.com/rmcrackan/Libation/releases/download/v12.5.4/Libation.12.5.4-linux-chardonnay-amd64.rpm
        - neovim
        - rmlint
        - starship
        - synology-drive-noextra
    remove:
      packages:
        - tailscale

  - type: default-flatpaks
    configurations:
      - scope: user
        repo:
          # you can override the title to make inclusion of both system and user repos clearer
          title: Flathub (user)
      - notify: true
        scope: system
        repo:
          title: Flathub (system)
        install: # system flatpaks we want all users to have and not remove
          - com.github.tchx84.Flatseal
          - com.vscodium.codium
          - io.github.dvlv.boxbuddyrs
          - io.github.flattool.Warehouse
          - io.github.pol_rivero.github-desktop-plus
          - io.github.pwr_solaar.solaar
          - io.gitlab.librewolf-community
          - io.podman_desktop.PodmanDesktop
          - org.keepassxc.KeePassXC
          - org.libreoffice.LibreOffice
          - org.signal.Signal

  - type: fonts
    fonts:
      nerd-fonts:
        - Hack
        - Terminus

  - type: systemd
    system:
      enabled:
        - clatd.service
        - podman.service
        - sshd.service
        - zram-compaction.timer
        - zram-recompression.timer
      masked:
        - cpupower.service
        - power-profiles-daemon.service
        - tuned.service

  - type: kargs
    arch: x86_64
    kargs:
      - rootflags=subvol=root,compress-force=zstd:3,discard=async,lazytime,noatime,space_cache=v2,x-systemd.device-timeout=0

  - type: signing
