---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: bazzite-stable-customized
description: My personal flavor of Bazzite
base-image: ghcr.io/ublue-os/bazzite
image-version: stable-43

modules:
  - type: dnf
    repos:
      copr:
        - emixampp/synology-drive
    install:
      packages:
        - cdrskin
        - clatd
        - ddrescue
        - git
        - htop
        - k3b
        - https://github.com/rmcrackan/Libation/releases/download/v12.5.4/Libation.12.5.4-linux-chardonnay-amd64.rpm
        - lziprecover
        - micro
        - openrgb
        - rmlint
        - synology-drive-noextra
    remove:
      packages:
        - rocm-hip
        - rocm-opencl
        - rocm-clinfo
        - rocm-smi
        - tailscale

  - type: fonts
    fonts:
      nerd-fonts:
        - Hack
        - Terminus

  - type: chezmoi
    repository: "https://github.com/OmegaSquad82/dotfiles"

  - type: files
    files:
      - source: system
        destination: /

  - type: default-flatpaks
    configurations:
      - notify: false
        scope: user
        repo:
          title: Flathub (user)
        install: # unverified flatpaks go here to easily tell the difference
          - com.calibre_ebook.calibre
          - com.nextcloud.desktopclient.nextcloud
          - io.github.pwr_solaar.solaar
          - org.jitsi.jitsi-meet
          - org.signal.Signal
          - org.videolan.VLC
      - notify: false
        scope: system
        repo:
          title: Flathub (system)
        install: # system flatpaks we want all users to have and not remove
          - com.daniel15.wcc
          - com.discordapp.Discord
          - com.github.Matoking.protontricks
          - com.github.tchx84.Flatseal
          - com.logseq.Logseq
          - com.ranfdev.DistroShelf
          - com.usebottles.bottles
          - com.vysp3r.ProtonPlus
          - org.fedoraproject.MediaWriter
          - info.beyondallreason.bar
          - io.github.flattool.Warehouse
          - io.github.nroduit.Weasis
          - io.gitlab.librewolf-community
          - io.github.pieterdd.StretchBreak
          - io.github.pol_rivero.github-desktop-plus
          - io.github.ungoogled_software.ungoogled_chromium
          - io.podman_desktop.PodmanDesktop
          - md.obsidian.Obsidian
          - net.ptilouk.superfluous
          - org.mozilla.Thunderbird
          - org.kde.gwenview
          - org.kde.haruna
          - org.kde.kcalc
          - org.kde.okular
          - org.keepassxc.KeePassXC
          - org.libreoffice.LibreOffice
          - org.torproject.torbrowser-launcher

  - type: systemd
    system:
      enabled:
        - clatd.service
        - podman.service
        - sshd.service
        - zram-compaction.timer
        - zram-recompression.timer

  - type: kargs
    arch: x86_64
    kargs:
      - rootflags=subvol=root,compress-force=zstd:3,discard=async,lazytime,noatime,space_cache=v2,x-systemd.device-timeout=0

  - type: signing
